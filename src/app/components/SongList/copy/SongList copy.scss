// 变量定义
$primary-color: #ffffff;
$secondary-color: #1db954;
$bg-color: #121212;
$bg-secondary: #181818;
$text-secondary: #b3b3b3;
$cover-size: 8vw; // 调整为vw单位
$small-cover-size: 6vw; // 调整为vw单位
$border-radius: 0.8vw; // 调整为vw单位
$control-height: 8vh; // 调整为vh单位
$transition: all 0.3s ease;

// 基础样式
.song-player-container {
  display: flex;
  flex-wrap: wrap;
  width: 100vw;
  height: 92vh;
  color: $primary-color;
  font-family:
    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu,
    Cantarell, sans-serif;
  overflow: hidden;

  // 歌曲列表区域
  .song-list {
    flex: 1;
    width: 30vw; // 固定宽度30vw
    height: 81vh;
    padding: 1vh 0; // 移除水平padding，只在垂直方向添加padding
    display: flex;

    flex-direction: column;
    align-items: center;

    .list-title {
      width: 85%;
      text-align: center;
      height: 3vh;
      line-height: 3vh;
      font-size: 1.8vw;
      font-weight: bold;
      padding: 1vh 0vw; // 只在水平方向添加padding
      border-top: 0.3vw solid rgba($primary-color, 0.1);
    }

    .song-list-container {
      width: 85%; // 确保容器宽度与父容器一致
      padding: 1vh 0vw; // 只在水平方向添加paddin
      border-top: 0.3vw solid rgba($primary-color, 0.1);
      border-bottom: 0.3vw solid rgba($primary-color, 0.1);
      overflow-y: scroll;
      scroll-snap-type: y proximity;
      scrollbar-width: none;
      // border-bottom: 0.3vw solid rgba($primary-color, 0.1);
      ::-webkit-scrollbar {
        display: none;
      }
      .song-item {
        width: 100%;
        margin: 0vh 0 1vh 0; // 水平margin与父容器的padding一致
        display: flex;
        align-items: center;
        padding: 1vw 0;
        border-radius: $border-radius;
        transition: $transition;
        cursor: pointer;
        background-color: rgba($primary-color, 0.05);
        box-sizing: border-box; // 确保padding和border包含在宽度内

        &:hover {
          background-color: rgba($primary-color, 0.1);
        }

        &.active {
          background-color: rgba($secondary-color, 0.2);
        }

        img {
          width: $cover-size;
          height: $cover-size;
          min-width: 50px;
          min-height: 50px;
          border-radius: $border-radius;
          object-fit: cover;
          margin: 0 1vw;
          box-shadow: 0 0.4vw 0.8vw rgba(0, 0, 0, 0.2);
        }

        .song-info {
          flex: 1;
          min-width: 0;

          .song-name {
            font-size: 1.2vw;
            margin-bottom: 0.5vh;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
          }
        }
        .playing-icon {
          margin: 0 1.5vw;
          color: $secondary-color;
          font-weight: bold;
          font-size: 1.2vw;
        }
      }
    }
  }
  //主展示区域
  .song-display-container {
    width: 60vw;
    height: 81vh;
    display: flex;
    justify-content: center;
    align-items: center;
    .current-song-display {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5vh;
      .display-cover {
        height: 40vw;
        width: 40vw;
        max-width: 400px;
        max-height: 400px;
        border-radius: 50%;
      }
    }
  }
  /* 外层容器 */
  .display-info {
    width: 40vw;
    height: 15vw;
    min-width: 300px; /* 最小宽度保护 */
    min-height: 150px; /* 最小高度保护 */
    max-height: 200px;
    background: rgba(0, 0, 0, 0.6); /* 半透明背景 */
    border-radius: 8px;
    padding: 1.2vw;
    box-sizing: border-box;
    backdrop-filter: blur(5px); /* 毛玻璃效果 */
    overflow: hidden;
  }
  //波形
  // 波形图容器 - 更新部分
  .waveform-container {
    width: 100%;
    height: 80px; // 固定高度
    margin: 10px 0;
    background: rgba(255, 255, 255, 0.05); // 更柔和的背景
    border-radius: $border-radius;
    overflow: hidden;
    position: relative;

    // 加载状态指示器
    &::before {
      content: "加载波形...";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: $text-secondary;
      font-size: 14px;
      z-index: 1;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    &.loading::before {
      opacity: 1;
    }

    wave {
      display: block;
      width: 100%;
      height: 100%;
      cursor: pointer;
      transition: opacity 0.3s ease;

      // 波形图渐变色
      & > wave {
        background: linear-gradient(
          to right,
          rgba($secondary-color, 0.3),
          rgba($secondary-color, 0.7)
        );
      }
    }
  }

  // 确保控制面板布局适应波形图
  .control-container {
    display: flex;
    width: 100%;
    .all-container {
      width: 100%;
    }
  }
  /* 歌词滚动容器 */
  .lyrics-container {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    gap: 10px;
    font-size: 28px;
    overflow-y: scroll;
    scroll-snap-type: y proximity;
    scrollbar-width: none;
    cursor: pointer;
    ::-webkit-scrollbar {
      display: none;
    }
  }
  /* 单行歌词样式 */
  .lyric-line {
    color: rgba(255, 255, 255, 0.7);
    font-size: 17px;
    text-align: center;
    padding: 0.3vw 0;
    transition: all 0.2s ease;
    line-height: 1.5;
  }

  /* 当前高亮歌词 */
  .lyric-line.active {
    height: 50%;
    color: #1db954; /* Spotify绿 */
    font-size: 20px;
    font-weight: 500;
    text-shadow: 0 0 1px rgba(29, 185, 84, 0.5);
  }

  /* 无歌词提示 */
  .no-lyrics {
    color: rgba(255, 255, 255, 0.5);
    font-size: 1.2vw;
    text-align: center;
    margin-top: 5vw;
  }
  // 播放控制面板
  .player-controls {
    width: 100vw;
    height: $control-height;
    min-height: 50px; // 设置最小高度
    max-height: 70px; // 设置最大高度
    padding: 0 2vw;
    display: flex;
    align-items: center;
    box-sizing: border-box;
    position: relative;
    overflow: hidden;

    audio {
      display: none;
    }

    .control-container {
      width: 100%;
      height: 100%; // 使容器填满父元素高度
      border-radius: $border-radius;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 1vw;
      box-sizing: border-box;

      .info-container {
        display: flex;
        align-items: center;
        width: 25vw;
        max-width: 250px;
        height: 100%; // 填满容器高度

        .control-cover {
          width: auto; // 改为自动适应
          height: 70%; // 基于容器高度
          min-width: 40px;
          max-width: 50px;
          min-height: 40px;
          max-height: 50px;
          border-radius: $border-radius;
          object-fit: cover;
          margin-right: 1.5vw;
        }

        .control-info {
          height: 100%;
          display: flex;
          flex-direction: column;
          justify-content: center;
          overflow: hidden;

          .control-title {
            font-size: clamp(12px, 1vw, 14px);
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.2;
          }
        }
      }
      .volume-control {
        display: flex;
        align-items: center;
        margin-left: 15px;

        .volume-button {
          background: none;
          border: none;
          font-size: 20px;
          cursor: pointer;
          padding: 5px;
          color: white;
        }

        .volume-slider {
          width: 80px;
          margin-left: 8px;
          height: 4px;
          background: #ddd;
          border-radius: 2px;
          outline: none;

          &::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #fff;
            cursor: pointer;
          }
        }
      }
      .all-container {
        width: 40vw;
        max-width: 380px;
        min-width: 280px;
        height: 100%; // 填满容器高度
        display: flex;
        flex-direction: column;
        align-items: center;
        box-sizing: border-box;

        .button-container {
          display: flex;
          align-items: center;
          justify-content: center;
          margin: 4px 0;
          height: 60%; // 基于容器高度

          button {
            background: none;
            border: none;
            color: $primary-color;
            cursor: pointer;
            transition: $transition;
            padding: 0;
            border-radius: 50%;
            font-size: clamp(12px, 1.2vw, 14px);
            min-width: 28px;
            min-height: 28px;
            max-height: 36px;
            background-color: rgba($primary-color, 0.1);
            &:hover {
              transform: scale(1.05);
            }

            &.play-button {
              background-color: $secondary-color;
              width: clamp(25px, 3.5vw, 30px);
              height: clamp(25px, 3.5vw, 30px);
              margin: 0 12px;
              font-size: clamp(12px, 1.3vw, 15px);
              z-index: 1;
              &:hover {
                transform: scale(1.05);
              }
            }
          }
          //循环键
          .loop-button {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            margin: 0 5px;
            transition: all 0.2s;

            &:hover {
              background: rgba(255, 255, 255, 0.2);
            }

            &.active {
              background: rgba(0, 150, 255, 0.3);
              color: $secondary-color;
            }
          }
          //倍速键
          .speed-button {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            margin: 0 5px;
            transition: all 0.2s;

            &:hover {
              background: rgba(255, 255, 255, 0.2);
            }
          }
        }

        .show-container {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 300px; // 固定宽度
          height: 40px; // 固定高度
          padding: 0 10px;
          box-sizing: border-box; // 确保padding不会影响总宽度

          .current-time,
          .all-time {
            font-size: 12px;
            min-width: 40px; // 确保时间显示有足够空间
            text-align: center;
          }

          .time-bar {
            height: 4px;
            flex: 1;
            margin: 0 10px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            &:hover {
              transform: scaleY(1.5);
            }
            cursor: pointer;
            .progress {
              height: 100%;
              background-color: #1db954;
              border-radius: 4px;
              position: relative;
            }
            .progress::after {
              content: "";
              position: absolute;
              right: 0;
              top: 50%;
              width: 9px; /* 圆的直径 */
              height: 6px;
              background: white;
              border-radius: 50%; /* 圆形 */
              transform: translate(50%, -50%); /* 精确居中 */
              box-shadow: 0 0 2px rgba(0, 0, 0, 0.3); /* 可选：添加轻微阴影增强立体感 */
              opacity: 0;
            }
            .progress:hover::after {
              transform: translate(50%, -50%);
              opacity: 1;
            }
          }
        }
      }
    }
  }
}

// 响应式设计 - 取消注释并更新
@media (max-width: 768px) {
  .song-player-container {
    flex-direction: column;
    height: auto;

    .song-list,
    .song-display-container {
      width: 100vw;
      height: auto;
    }

    .player-controls {
      height: auto;
      padding: 10px;

      .control-container {
        padding: 0 10px;

        .waveform-container {
          height: 60px;
          margin: 5px 0;
        }

        .all-container {
          width: 100%;

          .button-container {
            button {
              min-width: 24px;
              min-height: 24px;
              font-size: 12px;

              &.play-button {
                width: 28px;
                height: 28px;
              }
            }
          }
        }
      }
    }
  }
}
